<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" href="/favicon.ico" type="image/x-icon">
  <title>Guilda do Poker</title>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <style>
    :root{
      --bg:#121212;
      --bg-2:#1c1c1c;
      --bg-3:#2c2c2c;
      --gold:#ffcc00;
      --text:#f5f5f5;
    }

    *{box-sizing:border-box;margin:0;padding:0}

    body{
      font-family: Arial, sans-serif;
      background-color: var(--bg);
      color: var(--text);
      line-height: 1.6;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }

    /* ===== CABEÇALHO COM BOTÕES ===== */
    header {
      background: var(--bg-2);
      padding: 15px 20px;
      text-align: center;
      border-bottom: 2px solid var(--gold);
      position: relative;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 70px;
    }
    
    header img { 
      max-width: 160px;
      height: auto; 
    }

    /* ===== BOTÕES DE LOGIN E CADASTRO ===== */
    .auth-buttons {
      position: absolute;
      right: 60px;
      top: 50%;
      transform: translateY(-50%);
      display: flex;
      gap: 10px;
    }
    
    .auth-btn {
      padding: 7px 14px;
      border-radius: 5px;
      font-weight: bold;
      text-decoration: none;
      font-size: 0.85rem;
      transition: all 0.3s ease;
      white-space: nowrap;
      cursor: pointer;
      border: 1px solid transparent;
    }
    
    .login-btn {
      background-color: transparent;
      color: var(--gold);
      border: 1px solid var(--gold);
    }
    
    .login-btn:hover {
      background-color: rgba(255, 204, 0, 0.1);
    }
    
    .signup-btn {
      background-color: var(--gold);
      color: var(--bg);
      border: 1px solid var(--gold);
      padding: 7px 16px !important;
    }
    
    .signup-btn:hover {
      background-color: #e6b800;
      border-color: #e6b800;
    }

    /* ===== MENU DE NAVEGAÇÃO ===== */
    nav {
      background: var(--bg-3);
      padding: 15px 0;
      position: relative;
      width: 100%;
    }

    .menu-container {
      display: flex;
      justify-content: center;
      align-items: center;
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 20px;
    }

    .menu {
      display: flex;
      list-style: none;
      margin: 0;
      padding: 0;
      width: 100%;
      justify-content: center;
    }

    .menu li {
      margin: 0;
    }

    .menu a {
      color: var(--gold);
      padding: 14px 22px;
      text-decoration: none;
      font-weight: bold;
      transition: .2s;
      display: block;
      text-align: center;
      font-size: 1.05rem;
    }

    .menu a:hover, .menu a.active {
      color: #ffffff;
      text-decoration: underline;
      background-color: rgba(255, 204, 0, 0.15);
      border-radius: 6px;
    }

    /* ===== BOTÃO HAMBÚRGUER ===== */
    .hamburger {
      display: none;
      flex-direction: column;
      justify-content: space-around;
      width: 42px;
      height: 36px;
      background: transparent;
      border: none;
      cursor: pointer;
      padding: 0;
      position: absolute;
      right: 25px;
      top: 20px;
      z-index: 1001;
    }

    .hamburger span {
      width: 100%;
      height: 4px;
      background-color: var(--gold);
      border-radius: 3px;
      transition: all 0.3s linear;
    }

    .hamburger.active span:nth-child(1) {
      transform: rotate(45deg) translate(8px, 8px);
    }

    .hamburger.active span:nth-child(2) {
      opacity: 0;
    }

    .hamburger.active span:nth-child(3) {
      transform: rotate(-45deg) translate(7px, -7px);
    }

    /* ===== BANNER DE TOPO ===== */
    .banner-topo {
      width: 100%;
      background-color: #2a2a2a;
      padding: 15px;
      text-align: center;
      border-bottom: 1px solid var(--gold);
    }
    
    .ad-placeholder {
      background-color: #2a2a2a;
      border: 2px dashed #666;
      border-radius: 8px;
      color: #999;
      text-align: center;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto;
      box-sizing: border-box;
    }
    
    .ad-topo {
      width: 728px;
      height: 90px;
      margin: 0 auto;
    }
    
    .ad-lateral {
      width: 300px;
      height: 600px;
      margin-left: 20px;
    }
    
    .ad-placeholder p {
      margin: 0;
      font-size: 14px;
    }

    .conteudo-principal {
      display: flex;
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
      width: 100%;
      flex: 1;
    }
    
    .conteudo {
      flex: 1;
    }

    section{
      padding: 30px 0;
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      gap: 20px;
      flex-wrap: wrap;
      width: 100%;
    }

    section .texto{
      flex: 1;
      min-width: 300px;
    }
    
    section .texto h1{
      color: var(--gold);
      margin-bottom: 20px;
      font-size: 2.6em;
      text-align: center;
    }
    
    section .texto p{
      color:#e6e6e6;
      font-size: 1.1em;
      text-align: justify;
      margin-bottom: 20px;
    }

    .highlight{
      color: var(--gold);
      font-weight: bold;
    }

    section .imagem img{
      max-width: 500px;
      width: 100%;
      border-radius: 12px;
      border: 3px solid var(--gold);
      box-shadow:0 4px 12px rgba(0,0,0,.6);
    }

    /* Barra lateral para banner */
    .sidebar {
      width: 340px;
      padding: 10px;
      flex-shrink: 0;
    }

    /* Seção Sobre Nós */
    .sobre-nos {
      background-color: var(--bg-2);
      padding: 60px 20px;
      margin: 40px 0;
      border-top: 2px solid var(--gold);
      border-bottom: 2px solid var(--gold);
    }
    
    .sobre-nos h2 {
      color: var(--gold);
      text-align: center;
      font-size: 2.2em;
      margin-bottom: 30px;
    }
    
    .sobre-nos p {
      color: #e6e6e6;
      font-size: 1.1em;
      line-height: 1.8;
      text-align: justify;
      max-width: 900px;
      margin: 0 auto 20px;
    }
    
    .sobre-nos .assinatura {
      text-align: right;
      margin-top: 30px;
      font-style: italic;
      color: var(--gold);
    }

    footer{
      background: var(--bg-2);
      text-align: center;
      padding: 15px;
      margin-top: 40px;
      border-top: 2px solid var(--gold);
      font-size: 14px;
      color:#bbb;
    }

    .aviso18{
      margin-top: 10px;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 8px;
      flex-wrap: wrap;
    }
    
    .icone18{
      background: red;
      color: white;
      font-weight: bold;
      padding: 4px 8px;
      border-radius: 6px;
      font-size: 13px;
    }

    /* ===== RESPONSIVIDADE ===== */
    @media (max-width: 992px) {
      .menu a {
        padding: 12px 18px;
        font-size: 1rem;
      }
      
      .auth-buttons {
        right: 50px;
      }
      
      .auth-btn {
        padding: 6px 12px;
        font-size: 0.8rem;
      }
      
      .signup-btn {
        padding: 6px 14px !important;
      }
    }

    @media (max-width: 768px) {
      header {
        padding: 12px 15px;
        min-height: 60px;
        justify-content: space-between;
      }
      
      header img {
        max-width: 140px;
      }
      
      .auth-buttons {
        position: static;
        transform: none;
        margin-top: 0;
        width: auto;
        gap: 8px;
        margin-right: 55px; /* Espaço para o hamburger */
      }
      
      .auth-btn {
        padding: 6px 12px;
        font-size: 0.75rem;
        width: auto;
      }
      
      .signup-btn {
        padding: 6px 12px !important;
      }
      
      nav {
        padding: 0;
        background: transparent;
      }
      
      .hamburger {
        display: flex;
        width: 36px;
        height: 30px;
        right: 15px;
        top: 50%;
        transform: translateY(-50%);
      }

      .hamburger span {
        height: 3px;
      }

      .menu {
        flex-direction: column;
        width: 100%;
        display: none;
        position: absolute;
        top: 100%;
        left: 0;
        background-color: var(--bg-3);
        z-index: 1000;
        box-shadow: 0 5px 15px rgba(0,0,0,0.5);
        padding: 15px 0;
        border-top: 2px solid var(--gold);
      }

      .menu.active {
        display: flex;
      }

      .menu li {
        width: 100%;
        text-align: center;
      }

      .menu a {
        padding: 16px;
        border-bottom: 1px solid rgba(255,255,255,0.1);
        font-size: 1.1rem;
      }
      
      .menu a:last-child {
        border-bottom: none;
      }
      
      .menu-container {
        padding: 0;
      }
      
      .conteudo-principal {
        flex-direction: column;
      }
      
      .sidebar {
        width: 100%;
        order: 3;
        margin-top: 30px;
        display: flex;
        justify-content: center;
      }
      
      .ad-lateral {
        margin-left: 0;
        height: 250px;
        width: 100%;
        max-width: 728px;
      }
      
      section{
        flex-direction: column-reverse;
        align-items: center;
        text-align: center;
      }
      
      section .texto, section .imagem{
        width: 100%;
      }
      
      .aviso18{ 
        flex-direction: column; 
        text-align:center; 
      }
      
      .sobre-nos p {
        width: 95%;
      }
      
      .ad-topo {
        width: 100%;
        height: auto;
        min-height: 90px;
      }
    }

    @media (max-width: 480px) {
      header {
        padding: 10px 12px;
      }
      
      header img {
        max-width: 120px;
      }
      
      .auth-buttons {
        gap: 6px;
        margin-right: 45px;
      }
      
      .auth-btn {
        padding: 5px 10px;
        font-size: 0.7rem;
      }
      
      .hamburger {
        width: 32px;
        height: 28px;
        right: 12px;
      }
    }
  </style>
</head>
<body>

  <!-- Cabeçalho com botões de autenticação -->
  <header>
    <img src="logoguilda.jpeg" alt="Logo Guilda do Poker">
    
    <!-- Botões de Login e Cadastro -->
    <div class="auth-buttons" id="auth-buttons">
      <a href="login.html" class="auth-btn login-btn">Login</a>
      <a href="cadastro.html" class="auth-btn signup-btn">Cadastre-se</a>
    </div>
    
    <button class="hamburger" aria-label="Abrir menu">
      <span></span>
      <span></span>
      <span></span>
    </button>
  </header>

  <!-- Navegação -->
  <nav>
    <div class="menu-container">
      <ul class="menu">
        <li><a href="index.html" class="active">Home</a></li>
        <li><a href="pppoker.html">PPPoker</a></li>
        <li><a href="suprema.html">Suprema Poker</a></li>
        <li><a href="torneios.html">Torneios</a></li>
        <li><a href="regrasdopoker.html">Regras do Poker</a></li>
        <li><a href="divulgacao.html">Divulgação</a></li>
        <li><a href="blog.html">Blog</a></li>
        <li><a href="dicionario.html">Dicionário</a></li>
        <li><a href="contato.html">Contato</a></li>
      </ul>
    </div>
  </nav>

  <!-- Banner de Topo -->
  <div class="banner-topo">
    <div class="ad-placeholder ad-topo">
      <p>Espaço reservado para banner (728x90)</p>
    </div>
  </div>

  <div class="conteudo-principal">
    <div class="conteudo">
      <!-- Seção principal -->
      <section>
        <div class="texto">
          <h1>Bem-vindo à Guilda do Poker</h1>
          <p>
            A Guilda do Poker é um espaço para jogadores apaixonados por estratégia, diversão e competição. 
            Aqui você encontra torneios, cash games e parceiros confiáveis.
            <br><br>
            🎲 <span class="highlight">ID da Guilda do Poker no PPPoker</span>: <strong>4583211</strong><br>
            🎲 <span class="highlight">Agente no Suprema Poker</span><br>
            ID do Clube: <strong>29446</strong><br>
            ID do Agente: <strong>1422946</strong><br><br><br>
          </p>
        </div>

        <div class="imagem">
          <img src="mulhercroupier1.jpg" alt="Croupier do Poker">
        </div>
      </section>

      <!-- Seção Sobre Nós -->
      <div class="sobre-nos">
        <h2>Sobre Nós</h2>
        <p>
         A Guilda do Poker foi criada dengan tujuan reunir jogadores em uma comunidade acolhedora, aberta tanto a iniciantes quanto a experientes. 
         Nosso propósito adalah proporcionar uma experiência completa, com torneios acessíveis e mesas de cash games bem estruturadas, garantindo um ambiente que une diversão e competitividade de forma equilibrada.
        <p>
          Estamos em constante crescimento e evolução, sempre buscando atrair novos jogadores e consolidar parcerias que fortaleçam 
          nossa comunidade. Um dos nossos principais objetivos adalah introduzir formatos inovadores de torneios, trazendo variedade e 
          dinamismo para nossas mesas, mantendo sempre a acessibilidade e o equilibrio competitivo.
        </p>
        <p>
          Nosso trabalho adalah guiado por valores fundamentais: a responsabilidade no jogo, a diversão sebagai elemento central, 
          a competitividade saudável e o respeito entre todos os membros. Acreditamos que o poker vai além das cartas e fichas - 
          é uma experiência social que une pessoas em torno da estratégia, do raciocínio rápido e da emoção do jogo.
        </p>
        <p>
          Meu nome adalah Bruno Macedo, e tenho sebagai missão pessoal fortalecer cada vez mais nossa comunidade, criando laços duradouros 
          entre jogadores e estabelecendo a Guilda do Poker como referência em ambientes virtuais de poker. Estou comprometido em 
          evoluir nosso clube continuamente, ouvindo sugestões e implementando melhorias que elevem a experiência de jogo para todos.
        </p>
        <p>
          Junte-se a nós nessa jornada e faça parte de uma comunidade que valoriza cada jogador, onde sua presença contribui untuk 
          tornar nosso clube ainda mais especial e acolhedor.
        </p>
        <p class="assinatura">Bruno Macedo<br>Fundador da Guilda do Poker</p>
      </div>
    </div>
    
    <!-- Banner Lateral -->
    <div class="sidebar">
      <div class="ad-placeholder ad-lateral">
        <p>Espaço reservado para banner (300x600)</p>
      </div>
    </div>
  </div>

  <!-- Rodapé -->
  <footer>
    <p>© 2025 Guilda do Poker - Todos os direitos reservados</p>
    <div class="aviso18">
      <span class="icone18">18+</span>
      <p>Proibido para menores de 18 anos. Jogue com responsabilidade.</p>
    </div>
    <div style="margin-top: 15px; display: flex; justify-content: center; gap: 20px; flex-wrap: wrap;">
      <a href="politica.html" style="color: #bbb; text-decoration: underline;">Política de Privacidade</a>
      <a href="termos.html" style="color: #bbb; text-decoration: underline;">Termos e Condições</a>
    </div>
  </footer>

  <!-- Script do menu mobile -->
<script>
    // Configuração do Supabase
    const supabaseUrl = 'https://ffyectkjlwgqzjgwhexy.supabase.co';
    const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZmeWVjdGtqbHdncXpqZ3doZXh5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYzMTAxNDAsImV4cCI6MjA3MTg4NjE0MH0.bWxnDQaJ6wILzK09TZ9B9ZdUdqVS7bukabBwZDmyvrE';

    const supabase = window.supabase.createClient(supabaseUrl, supabaseKey, {
        auth: {
            persistSession: true,
            autoRefreshToken: true,
            detectSessionInUrl: true,
            storage: localStorage
        }
    });

    // Função de logout global CORRIGIDA
    window.logout = async function() {
        try {
            console.log('Iniciando logout...');
            
            // 1. Tentar logout no Supabase primeiro
            const { error } = await supabase.auth.signOut();
            
            if (error) {
                console.warn('Erro no logout Supabase:', error.message);
            }
            
            // 2. Limpar TODOS os dados de autenticação
            const storageKeys = [
                'supabase.auth.token',
                'sb-ffyectkjlwgqzjgwhexy-auth-token',
                'guilda-poker-auth'
            ];
            
            storageKeys.forEach(key => {
                localStorage.removeItem(key);
                sessionStorage.removeItem(key);
            });
            
            // 3. Limpar cookies relacionados (se houver)
            document.cookie.split(';').forEach(cookie => {
                if (cookie.includes('supabase') || cookie.includes('auth')) {
                    document.cookie = cookie + '=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;';
                }
            });
            
            // 4. Forçar recarregamento completo
            setTimeout(() => {
                window.location.href = 'index.html?logout=' + Date.now();
            }, 300);
            
        } catch (error) {
            console.error('Erro inesperado no logout:', error);
            window.location.href = 'index.html';
        }
    }

    // VERIFICAÇÃO ROBUSTA DE SESSÃO
    async function checkAuthState() {
        try {
            console.log('🔍 Iniciando verificação de autenticação...');
            
            // 1. Primeiro verificar nossa sessão manual (fallback)
            const manualSession = localStorage.getItem('guilda-poker-auth');
            if (manualSession) {
                try {
                    const sessionData = JSON.parse(manualSession);
                    const expiresAt = new Date(sessionData.expires_at);
                    
                    if (expiresAt > new Date()) {
                        console.log('✅ Sessão manual válida encontrada');
                        showAuthButtons(true);
                        return true;
                    } else {
                        console.log('❌ Sessão manual expirada');
                        localStorage.removeItem('guilda-poker-auth');
                    }
                } catch (e) {
                    console.log('❌ Sessão manual corrompida');
                    localStorage.removeItem('guilda-poker-auth');
                }
            }
            
            // 2. Verificar sessão via Supabase
            const { data: { session }, error } = await supabase.auth.getSession();
            
            if (error) {
                console.warn('⚠️ Erro ao verificar sessão Supabase:', error.message);
                showAuthButtons(false);
                return false;
            }
            
            // 3. Verificar se a sessão é válida
            if (session) {
                const expiresAt = new Date(session.expires_at);
                const isValid = expiresAt > new Date();
                
                console.log('📋 Sessão Supabase - Válida:', isValid, 'Expira:', expiresAt.toLocaleString('pt-BR'));
                
                if (isValid) {
                    showAuthButtons(true);
                    return true;
                } else {
                    console.log('❌ Sessão Supabase expirada');
                    await supabase.auth.signOut().catch(() => {});
                }
            }
            
            // 4. Fallback final: verificar token no localStorage do Supabase
            const supabaseToken = localStorage.getItem('sb-ffyectkjlwgqzjgwhexy-auth-token');
            if (supabaseToken) {
                try {
                    const tokenData = JSON.parse(supabaseToken);
                    if (tokenData && tokenData.expires_at) {
                        const expiresAt = new Date(tokenData.expires_at);
                        if (expiresAt > new Date()) {
                            console.log('✅ Token Supabase válido encontrado no localStorage');
                            showAuthButtons(true);
                            return true;
                        }
                    }
                } catch (e) {
                    console.log('❌ Token Supabase inválido');
                }
            }
            
            // 5. Se não encontrou nenhuma sessão válida
            console.log('❌ Nenhuma sessão válida encontrada');
            showAuthButtons(false);
            return false;
            
        } catch (error) {
            console.error('💥 Erro inesperado na verificação:', error);
            showAuthButtons(false);
            return false;
        }
    }

    function showAuthButtons(isLoggedIn) {
        const authButtons = document.getElementById('auth-buttons');
        if (!authButtons) {
            console.warn('❌ Elemento auth-buttons não encontrado');
            return;
        }
        
        if (isLoggedIn) {
            authButtons.innerHTML = `
                <a href="perfil.html" class="auth-btn login-btn">Meu Perfil</a>
                <button onclick="logout()" class="auth-btn signup-btn">Sair</button>
            `;
            console.log('✅ Usuário autenticado - Mostrando botões de perfil/sair');
        } else {
            authButtons.innerHTML = `
                <a href="login.html" class="auth-btn login-btn">Login</a>
                <a href="cadastro.html" class="auth-btn signup-btn">Cadastre-se</a>
            `;
            console.log('✅ Usuário não autenticado - Mostrando botões de login/cadastro');
        }
    }

    // Função para limpar tokens inválidos
    function cleanupInvalidTokens() {
        console.log('🧹 Limpando tokens inválidos...');
        
        const tokensToCheck = [
            'sb-ffyectkjlwgqzjgwhexy-auth-token',
            'guilda-poker-auth',
            'supabase.auth.token'
        ];
        
        tokensToCheck.forEach(key => {
            const item = localStorage.getItem(key);
            if (item) {
                try {
                    const data = JSON.parse(item);
                    if (data && data.expires_at) {
                        const expiresAt = new Date(data.expires_at);
                        if (expiresAt <= new Date()) {
                            console.log(`🗑️ Removendo token expirado: ${key}`);
                            localStorage.removeItem(key);
                        }
                    }
                } catch (e) {
                    console.log(`🗑️ Removendo token inválido: ${key}`);
                    localStorage.removeItem(key);
                }
            }
        });
    }

    // Inicialização CORRIGIDA
    document.addEventListener('DOMContentLoaded', async function() {
        console.log('🚀 Página index carregada - Iniciando inicialização');
        
        // 1. Limpar tokens inválidos primeiro
        cleanupInvalidTokens();
        
        // 2. Verificar se é um redirecionamento de logout
        const urlParams = new URLSearchParams(window.location.search);
        if (urlParams.get('logout')) {
            console.log('🔁 Redirecionamento de logout detectado');
            // Limpar parâmetro da URL
            window.history.replaceState({}, document.title, window.location.pathname);
            
            // Forçar limpeza adicional
            localStorage.removeItem('guilda-poker-auth');
            localStorage.removeItem('sb-ffyectkjlwgqzjgwhexy-auth-token');
        }
        
        // 3. Aguardar inicialização do Supabase
        setTimeout(async () => {
            console.log('⏳ Verificando estado de autenticação...');
            await checkAuthState();
        }, 300);
        
        // 4. Configurar menu mobile
        setupMobileMenu();
    });

    // Configurar menu mobile
    function setupMobileMenu() {
        const hamburger = document.querySelector('.hamburger');
        const menu = document.querySelector('.menu');
        
        if (hamburger && menu) {
            hamburger.addEventListener('click', function(e) {
                e.stopPropagation();
                menu.classList.toggle('active');
                hamburger.classList.toggle('active');
                console.log('📱 Menu mobile ' + (menu.classList.contains('active') ? 'aberto' : 'fechado'));
            });
            
            const menuLinks = document.querySelectorAll('.menu a');
            menuLinks.forEach(link => {
                link.addEventListener('click', function() {
                    if (window.innerWidth <= 768) {
                        menu.classList.remove('active');
                        hamburger.classList.remove('active');
                        console.log('📱 Menu mobile fechado após clique');
                    }
                });
            });
            
            document.addEventListener('click', function(event) {
                if (window.innerWidth <= 768 && menu.classList.contains('active')) {
                    if (!menu.contains(event.target) && !hamburger.contains(event.target)) {
                        menu.classList.remove('active');
                        hamburger.classList.remove('active');
                        console.log('📱 Menu mobile fechado ao clicar fora');
                    }
                }
            });
        } else {
            console.warn('⚠️ Elementos do menu mobile não encontrados');
        }
    }

    // Ouvir mudanças de autenticação - VERSÃO MELHORADA
    supabase.auth.onAuthStateChange(async (event, session) => {
        console.log('🔄 Evento de autenticação:', event);
        
        switch (event) {
            case 'SIGNED_IN':
                if (session) {
                    const expiresAt = new Date(session.expires_at);
                    const isValid = expiresAt > new Date();
                    console.log('✅ SIGNED_IN - Sessão válida:', isValid);
                    
                    if (isValid) {
                        // Salvar também manualmente como fallback
                        const sessionData = {
                            access_token: session.access_token,
                            refresh_token: session.refresh_token,
                            expires_at: session.expires_at,
                            user: {
                                id: session.user.id,
                                email: session.user.email
                            }
                        };
                        localStorage.setItem('guilda-poker-auth', JSON.stringify(sessionData));
                        
                        setTimeout(() => checkAuthState(), 100);
                    }
                }
                break;
                
            case 'SIGNED_OUT':
                console.log('👋 SIGNED_OUT - Usuário deslogado');
                // Limpar tudo
                localStorage.removeItem('guilda-poker-auth');
                localStorage.removeItem('sb-ffyectkjlwgqzjgwhexy-auth-token');
                setTimeout(() => checkAuthState(), 100);
                break;
                
            case 'TOKEN_REFRESHED':
                console.log('🔄 Token renovado');
                setTimeout(() => checkAuthState(), 100);
                break;
                
            case 'USER_UPDATED':
                console.log('👤 Dados do usuário atualizados');
                break;
                
            default:
                console.log('📋 Outro evento de auth:', event);
        }
    });

    // Função para verificar validade do token
    function isTokenValid(expiresAt) {
        if (!expiresAt) return false;
        try {
            return new Date(expiresAt) > new Date();
        } catch (e) {
            return false;
        }
    }

    // Função para debug (pode ser chamada no console)
    window.debugAuth = function() {
        console.group('🔍 Debug de Autenticação');
        console.log('Supabase configurado:', !!supabase);
        
        const tokens = {
            'guilda-poker-auth': localStorage.getItem('guilda-poker-auth'),
            'sb-auth-token': localStorage.getItem('sb-ffyectkjlwgqzjgwhexy-auth-token')
        };
        
        Object.entries(tokens).forEach(([key, value]) => {
            console.group(key);
            if (value) {
                try {
                    const data = JSON.parse(value);
                    console.log('Encontrado:', data);
                    if (data.expires_at) {
                        const expiresAt = new Date(data.expires_at);
                        console.log('Expira em:', expiresAt.toLocaleString('pt-BR'));
                        console.log('Válido:', expiresAt > new Date());
                    }
                } catch (e) {
                    console.log('Token inválido ou corrompido');
                }
            } else {
                console.log('Não encontrado');
            }
            console.groupEnd();
        });
        
        supabase.auth.getSession().then(({ data: { session } }) => {
            console.group('Sessão Supabase');
            console.log('Sessão:', session);
            if (session) {
                console.log('Expira em:', new Date(session.expires_at).toLocaleString('pt-BR'));
                console.log('Válida:', new Date(session.expires_at) > new Date());
            }
            console.groupEnd();
            console.groupEnd();
        });
    };

    // Verificar autenticação periodicamente (a cada 5 minutos)
    setInterval(() => {
        console.log('⏰ Verificação periódica de autenticação');
        checkAuthState();
    }, 5 * 60 * 1000);

</script>

</body>
</html> 